<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ›‰æ˜æ•¸å­¸ç§‘èšé¤äº¤é€šæ–¹å¼æš¨é›²ç«¯é»é¤çµ±è¨ˆç³»çµ±</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; padding: 20px; background-color: #f8f9fa; color: #333; }
        .main-container { display: flex; gap: 20px; max-width: 1300px; margin: auto; }
        .left-panel { flex: 2; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); height: 92vh; overflow-y: auto; }
        .right-panel { flex: 0.8; background: #2c3e50; color: white; padding: 20px; border-radius: 8px; position: sticky; top: 20px; height: fit-content; }
        
        /* æ¨è–¦é ç®—çµ„åˆå€å¡Š - æ¨£å¼åƒè€ƒä¾†æº [3] */
        .recommend-box { background: #fff8e1; border: 1px solid #ffe082; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9em; line-height: 1.6; }
        
        /* åˆ†é¡æ¨™é¡Œæ¨£å¼ - æ©˜è‰²åº•æ¢åƒè€ƒä¾†æº [4] */
        .category-header { background: #e67e22; color: white; padding: 8px 15px; margin: 20px 0 10px; border-radius: 4px; font-weight: bold; }
        
        .input-group { margin-bottom: 15px; }
        input[type="text"], select { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        .required-text { color: #e74c3c; font-size: 0.8em; }
        
        .item-row { display: block; margin: 8px 0; cursor: pointer; font-size: 0.95em; }
        .disabled { color: #ccc; text-decoration: line-through; cursor: not-allowed; }
        
        /* æŒ‰éˆ•æ¨£å¼åƒè€ƒä¾†æº [3] */
        .btn-submit { background: #7f8c8d; color: white; border: none; padding: 15px; width: 100%; border-radius: 5px; cursor: pointer; font-size: 1.1em; margin-top: 10px; font-weight: bold; transition: 0.3s; }
        .btn-submit.active { background: #27ae60; }
        .btn-clear { background: #e67e22; color: white; border: none; padding: 12px; width: 100%; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        
        .status-hint { color: #f1c40f; font-weight: bold; margin: 15px 0; font-size: 1.1em; }
        .footer-note { font-size: 0.8em; color: #bdc3c7; margin-top: 25px; line-height: 1.5; border-top: 1px solid #455a64; padding-top: 10px; }
    </style>
</head>
<body>
<h1 style="text-align:center; margin-bottom: 0;">æ›‰æ˜æ•¸å­¸ç§‘æœŸæœ«èšé¤</h1>
<h1 style="text-align:center; margin-top: 0;">äº¤é€šæ–¹å¼æš¨é›²ç«¯é»é¤çµ±è¨ˆç³»çµ±</h1>
    <div class="main-container">
        <div class="left-panel">            
            <!-- æ¨è–¦çµ„åˆå€å¡Šï¼šå·²ç§»é™¤ç„¡æ„ç¾©æ•¸å­— [5] -->
            <div class="recommend-box">
                ğŸ’¡ <strong>æ¨è–¦é ç®—çµ„åˆ (ğŸ´é¤é»é ç®— $750 - $850)</strong><br>
                â€¢ ğŸ‘‘æµ·é®®ç‡‰é£¯($698) + 1çƒå†°æ·‡æ·‹($128) = $826<br>
                â€¢ ğŸ‘‘å¹²è²å¥¶é†¬éºµ($588) + ğŸ‘‘ç¾…å‹’æª¸æª¬å¡”($228) = $816<br>
                â€¢ ğŸ‘‘å£æ°´é›ç¾©éºµ($398) + ğŸ‘‘æ­åŸ¹æ‹‰($268) + ğŸ‘‘ç”œæ©™å’–å•¡($168) = $834
            </div>

            <div class="input-group">
                <label><strong>1. åŒä»å§“å</strong> <span class="required-text">*å¿…å¡«</span></label>
                <input type="text" id="userName" placeholder="è«‹è¼¸å…¥å§“å" oninput="updateUI()">
            </div>
            <div class="input-group">
                <label><strong>2. å‰å¾€æ–¹å¼</strong></label>
                <select id="transport">
                    <option value="è‡ªè¡Œå‰å¾€">è‡ªè¡Œå‰å¾€</option>
                    <option value="å°šç„¡äº¤é€šæ–¹å¼">å°šç„¡äº¤é€šæ–¹å¼</option>
                    <option value="å…±ä¹˜">å…±ä¹˜</option>
                </select>
            </div>
            <hr>
            <div id="menuContainer"></div>
        </div>

        <div class="right-panel">
            <h3 style="border-bottom: 1px solid #455a64; padding-bottom: 10px;">æ‚¨çš„é»é¤æ‘˜è¦</h3>
            <div id="selectedList" style="min-height: 100px; font-size: 0.95em; line-height: 1.6;">å°šæœªé¸æ“‡é¤é»</div>
            <hr style="border: 0.5px solid #455a64;">
            <div style="font-size: 1.5em; font-weight: bold;">ç¸½é‡‘é¡ï¼š$<span id="totalDisplay">0</span></div>
            <div id="statusHint" class="status-hint">âš ï¸ è«‹å…ˆå¡«å¯«å§“å</div>
            <button id="submitBtn" class="btn-submit" onclick="uploadData()" disabled>ç¢ºèªæäº¤è‡³é›²ç«¯</button>
            <button class="btn-clear" onclick="clearOnlyMenu()">åƒ…æ¸…é™¤å·²é¸é¤é»</button>
            <div class="footer-note">
                â€» é»é¸ä¸»é¤å‡é™„ç†”å²©èµ·å£«éºµåŒ…ä¹™ä»½ã€‚<br>
                â€» ä¾›æ‡‰é™åˆ¶ï¼šPM 14:30-17:00 ä¸ä¾›æ‡‰ä¸»é¤ã€‚
            </div>
        </div>
    </div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxpraJFbxd7Q_x_xBiiztC4LW9Ka7dB18szbs1_Z-JcMbYsNUsFo5CQDSDKYipU4BXK/exec";
const budgetMin = 750, budgetMax = 850;
let currentItems = [], currentTotal = 0;

// åš´æ ¼ä¾ç…§ä¾†æº [1] è‡³ [2] çš„å…¨é …ç›®è³‡æ–™éŒ„å…¥
const menuData = [
    { cat: "ä¸»å»šæ’é¤ (é™„éºµåŒ…)", items: [
        { n: "ğŸ‘‘ ç¾©å¼æ¤’ç²’æµ·é¹½çƒ¤åŠé›", p: 698 }, { n: "ğŸ‘‘ æŒªå¨é¦™ç…é®­é­šæ­åŒ—æµ·é“å¹²è²", p: 798 },
        { n: "æ³•å¼æ²¹å°é´¨è…¿ä½æ¡‘è‘šæœé‡€é†¬æ±", p: 798 }, { n: "å­£ç¯€é®®é­šä½é³³æ¢¨é¹¹æª¸æª¬å¥¶æ²¹é†¬æ±", p: 898 },
        { n: "ç¾åœ‹é ‚ç´šå®‰æ ¼æ–¯ç„¡éª¨ç‰›å°æ’", p: 998 }, { n: "ğŸ‘‘ PRIMEè²åŠ›ç‰›æ’ï½œè’œé¦™å¥¶é†¬", p: 1298 }
    ]},
    { cat: "ç¾©å¼ç‡‰é£¯ (é™„éºµåŒ…)", items: [
        { n: "å¥¶æ²¹èµ·å¸é‡è‡ (è”¬)", p: 398 }, { n: "ğŸ‘‘ åŒ—æ¸¯é»‘éº»æ²¹é›è‚‰", p: 398 },
        { n: "ç¾…é¦¬è±¬è‚‰è”¥é¹½ç‡‰é£¯", p: 398 }, { n: "ğŸ‘‘ é¦¬è³½ç„¡æ•µæµ·é®®", p: 698 }
    ]},
    { cat: "ç¾©å¤§åˆ©éºµ (é™„éºµåŒ…)", items: [
        { n: "é»‘æ¾éœ²æ²¹æ¸…ç‚’é®®è”¬é‡è‡ (è”¬)", p: 388 }, { n: "ğŸ‘‘ æ¸æ±Ÿå·è¾£å£æ°´é›çš®è›‹", p: 398 },
        { n: "æ¿ç…é®®è¦è¾£å¥¶æ²¹è²“è€³éºµ", p: 428 }, { n: "è¥¿è¥¿é‡ŒèŒ„æ±é¦™ç…é›è…¿æ’æ’éºµ", p: 428 },
        { n: "ğŸ‘‘ æ³°å¼é…¸è¾£é®®è¦", p: 488 }, { n: "ğŸ‘‘ åŒ—æµ·é“å¹²è²ä½å¥¶é†¬", p: 588 }
    ]},
    { cat: "é–‹èƒƒèœ", items: [
        { n: "ç¶“å…¸è¥¿è¥¿é‡Œæµ·é¹½è„†è–¯", p: 198 }, { n: "è„†è–¯å‡ç´šæµ·é¢¨æ«»èŠ±è¦ (+$69)", p: 267 },
        { n: "æ¾éœ²é¦¬éˆ´è–¯çƒ", p: 228 }, { n: "ğŸ‘‘ æ—¥æœ¬æµ·ç‚¸ç‰¡è £", p: 228 },
        { n: "è¾£é†¬ç‚¸é›ç¿…", p: 288 }, { n: "èŠ±æ¤’é…¥ç‚¸ä¸é¦™é­š", p: 288 },
        { n: "ğŸ‘‘ ç¾©å¼æ¸…ç‚’æ«›ç“œé®®è¦", p: 368 }, { n: "ğŸ‘‘ æ©„æ¬–æ²¹è’œå‘³é®®è¦", p: 368 },
        { n: "ğŸ‘‘ æ©„æ¬–æ²¹é¦™ç…ä¸­å·ä½ç³–æ¼¬æª¸æª¬", p: 388 }
    ]},
    { cat: "æ²™æ‹‰èˆ‡æ¹¯å“", items: [
        { n: "æ˜¥æ—¥æ²™æ‹‰æ­ç¶ å¥³ç¥é†¬ (è”¬)", p: 328 }, { n: "å¸‚å ´è£¡çš„å¸ƒæ‹‰å¡”", p: 368 },
        { n: "å¸‚å ´è£¡çš„å¸ƒæ‹‰å¡”+è¥¿ç­ç‰™é¢¨ä¹¾ç«è…¿ (+$39)", p: 407 },
        { n: "åŒ—æ­èœ‚èœœæŸšé¦™ç…™ç‡»é®­é­šç¾½è¡£ç”˜è—", p: 388 }, { n: "ğŸ‘‘ ç´å¥§è‰¯é¢¨ç‚™çƒ¤æ¥“ç³–åŸ¹æ ¹æ²¹é†‹", p: 388 },
        { n: "ä¸»å»šç§æˆ¿æ¹¯", p: 168 }, { n: "æ³•å¼å—ç“œå …æœæ¿ƒæ¹¯ (è”¬)", p: 168 }, { n: "ğŸ‘‘ é¦¬è³½è¦æ±æµ·é®®æ¸…æ¹¯", p: 368 }
    ]},
    { cat: "ç”œé»èˆ‡å†°æ·‡æ·‹ææ‹‰ç±³è˜‡", items: [
        { n: "ğŸ‘‘ ç¾…å‹’æª¸æª¬å¡” (è”¬)", p: 228 }, { n: "ğŸ‘‘ å¯éº—éœ² (ä¸€å…¥)", p: 88 }, { n: "ğŸ‘‘ å¯éº—éœ² (ä¸‰å…¥)", p: 238 },
        { n: "ğŸ‘‘ æ³•å¼æ­åŸ¹æ‹‰", p: 268 }, { n: "å·´æ–¯å…‹ä¹³é…ªè›‹ç³• (è”¬)", p: 268 }, { n: "æ³•å¼æ —å­å¡”", p: 268 },
        { n: "ğŸ‘‘ æ³•å¼å¤æ´›ç‰¹", p: 288 }, { n: "ğŸ‘‘ ç”œå¿ƒå†°æ·‡æ·‹ (1 SCOOP)", p: 128 }, { n: "ğŸ‘‘ ç”œå¿ƒå†°æ·‡æ·‹ (2 SCOOPS)", p: 168 },
        { n: "ğŸ‘‘ äººé­šçš„çœ¼æ·š", p: 138 }, { n: "ç¾©å¼é˜¿æ³•å¥‡æœµ", p: 188 },
        { n: "ğŸ‘‘ ç¶“å…¸åŸå‘³ææ‹‰ç±³è˜‡", p: 258 }, { n: "ç±³é¦™ç„™èŒ¶ææ‹‰ç±³è˜‡", p: 258 }
    ]},
    { cat: "å’–å•¡èˆ‡èŒ¶é£²", items: [
        { n: "ç¾å¼å’–å•¡", p: 128 }, { n: "ç¾©å¼æ¿ƒç¸® (SINGLE)", p: 118 }, { n: "ç¾©å¼æ¿ƒç¸® (DOUBLE)", p: 138 },
        { n: "ğŸ‘‘ ç”œæ©™å’–å•¡", p: 168 }, { n: "ğŸ‘‘ è¥¿è¥¿é‡Œæª¸æª¬æ°£æ³¡å’–å•¡", p: 168 },
        { n: "ğŸ‘‘ åŸå‘³æ‹¿éµ", p: 168 }, { n: "åŸå‘³æ‹¿éµ (æ›ç‡•éº¥å¥¶)", p: 198 },
        { n: "æµ·é¹½ç„¦ç³–æ‹¿éµ", p: 168 }, { n: "æµ·é¹½ç„¦ç³–æ‹¿éµ (æ›ç‡•éº¥å¥¶)", p: 198 },
        { n: "å¡å¸ƒå¥‡è«¾", p: 168 }, { n: "å¡å¸ƒå¥‡è«¾ (æ›ç‡•éº¥å¥¶)", p: 198 },
        { n: "éŒ«è˜­ç´…èŒ¶", p: 128 }, { n: "éŒ«è˜­ç´…èŒ¶æ­è•¾", p: 158 }, { n: "ğŸ‘‘ å†°æ·‡æ·‹ç´…èŒ¶", p: 158 },
        { n: "ğŸ‘‘ æ³¡æ³¡çç å¥¶èŒ¶", p: 168 }, { n: "ğŸ‘‘ ç¶“å…¸æ–°é®®æ°´æœèŒ¶", p: 188 }, { n: "ğŸ‘‘ å°‹å‘³ç„™èŒ¶æ­è•¾", p: 188 }
    ]},
    { cat: "æœæ±æ°£æ³¡é£²èˆ‡èŠ±è‰èŒ¶", items: [
        { n: "ğŸ‘‘ ç¾é¡æ·¨ç™½å¥‡ç•°æœæ±", p: 168 }, { n: "é™½å…‰ç´”å“é¦™æ©™æ±", p: 168 },
        { n: "å¥½æ¼¾æ°£è‰²ç¶œåˆæœæ±", p: 188 }, { n: "ğŸ‘‘ æ´»åŠ›èˆ’æ´»ç¶œåˆæœæ±", p: 188 },
        { n: "ğŸ‘‘ è‰·å¤ç«é¾æœå¾®æ³¡æ³¡", p: 168 }, { n: "ğŸ‘‘ ç†±å¸¶ç™¾é¦™é³³æ¢¨é†¬å†°æ·‡æ·‹è˜‡æ‰“", p: 168 },
        { n: "ä»²å¤èŠ’æœè‘¡è„æŸšå†°æ·‡æ·‹è˜‡æ‰“", p: 198 }, { n: "ğŸ‘‘ ç³–æ¼¬é»ƒæª¸æª¬å†°æ·‡æ·‹è˜‡æ‰“", p: 198 },
        { n: "ä»²å¤é‡è“å†°æ·‡æ·‹è˜‡æ‰“", p: 198 }, { n: "ğŸ‘‘ é¦™ç”œèœœæ¡ƒå†°æ·‡æ·‹è˜‡æ‰“", p: 198 },
        { n: "ğŸ‘‘ å¾·åœ‹Samovaèª¿æƒ…å¸«", p: 168 }, { n: "ğŸ‘‘ å¾·åœ‹SamovaèŠ±åœ’æ´¾å°", p: 168 },
        { n: "ğŸ‘‘ å¾·åœ‹D&Bå¿ƒéˆèˆ’å£“èŒ¶", p: 168 }, { n: "TOKI æ¼¢æ–¹èŒ¶-èˆ’å¿ƒå¤œå¥½", p: 168 },
        { n: "ğŸ‘‘ TOKI æ¼¢æ–¹èŒ¶-ç¶»é¡è¼•çº–", p: 168 }
    ]}
];

function render() {
    const container = document.getElementById('menuContainer');
    container.innerHTML = '';
    menuData.forEach(cat => {
        let html = `<div class="category-header">${cat.cat}</div>`;
        cat.items.forEach(item => {
            const isSelected = currentItems.some(i => i.n === item.n);
            const disabled = !isSelected && (currentTotal + item.p > budgetMax);
            html += `<label class="item-row ${disabled?'disabled':''}">
                <input type="checkbox" onchange="toggle('${item.n}',${item.p},this)" ${isSelected?'checked':''} ${disabled?'disabled':''}>
                ${item.n} ($${item.p})</label>`;
        });
        container.innerHTML += html;
    });
    updateUI();
}

function toggle(n, p, el) {
    if (el.checked) { currentItems.push({n, p}); currentTotal += p; }
    else { currentItems = currentItems.filter(i => i.n !== n); currentTotal -= p; }
    render();
}

function clearOnlyMenu() { currentItems = []; currentTotal = 0; render(); }

function updateUI() {
    const name = document.getElementById('userName').value.trim();
    document.getElementById('totalDisplay').innerText = currentTotal;
    document.getElementById('selectedList').innerText = currentItems.map(i => i.n).join(', ') || "å°šæœªé¸æ“‡";
    const btn = document.getElementById('submitBtn'), hint = document.getElementById('statusHint');
    
    const isBudgetOk = (currentTotal >= budgetMin && currentTotal <= budgetMax);
    const isNameOk = (name !== "");

    if (!isNameOk) {
        btn.disabled = true; btn.classList.remove('active');
        hint.innerText = "âš ï¸ è«‹å…ˆå¡«å¯«å§“å"; hint.style.color = "#f1c40f";
    } else if (!isBudgetOk) {
        btn.disabled = true; btn.classList.remove('active');
        hint.innerText = currentTotal > budgetMax ? "âŒ è¶…éé ç®—ä¸Šé™" : `é‚„å·® $${budgetMin - currentTotal} é”æ¨™`;
        hint.style.color = currentTotal > budgetMax ? "#e74c3c" : "#f1c40f";
    } else {
        btn.disabled = false; btn.classList.add('active');
        hint.innerText = "âœ… ç¬¦åˆé ç®—ï¼Œå¯æäº¤"; hint.style.color = "#2ecc71";
    }
}

async function uploadData() {
    const name = document.getElementById('userName').value;
    const transport = document.getElementById('transport').value;
    const btn = document.getElementById('submitBtn');
    btn.disabled = true; btn.innerText = "æäº¤ä¸­...";
    try {
        await fetch(SCRIPT_URL, {
            method: "POST", mode: "no-cors",
            body: JSON.stringify({ name, transport, items: currentItems.map(i=>i.n).join('+'), total: currentTotal })
        });
        alert("æäº¤æˆåŠŸï¼");
        clearOnlyMenu(); document.getElementById('userName').value = '';
    } catch (e) { alert("å¤±æ•—"); btn.disabled = false; }
}
render();
</script>
</body>
</html>