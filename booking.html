<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ›‰æ˜æ•¸å­¸ç§‘èšé¤äº¤é€šæ–¹å¼æš¨é›²ç«¯é»é¤çµ±è¨ˆç³»çµ±</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; padding: 20px; background-color: #f4f7f6; color: #333; }
        .main-layout { display: flex; gap: 20px; max-width: 1250px; margin: auto; }
        .menu-card { flex: 2; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); height: 85vh; overflow-y: auto; }
        .summary-card { flex: 1; background: #2c3e50; color: white; padding: 20px; border-radius: 10px; position: sticky; top: 20px; height: fit-content; }
        .recommend-box { background: #fff3e0; border: 1px solid #ffe0b2; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9em; line-height: 1.6; color: #333; }
        .category-title { background: #e67e22; color: white; padding: 5px 10px; margin: 15px 0 10px; border-radius: 4px; font-weight: bold; }
        .item-label { display: block; margin: 5px 0; cursor: pointer; padding: 3px 0; }
        .disabled { color: #ccc; text-decoration: line-through; cursor: not-allowed; }
        .btn-submit { background: #27ae60; color: white; border: none; padding: 15px; width: 100%; border-radius: 5px; cursor: pointer; font-size: 1.1em; margin-top: 10px; }
        .btn-submit:disabled { background: #7f8c8d; cursor: not-allowed; }
        .btn-clear { background: #e67e22; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; cursor: pointer; margin-top: 8px; }
        .input-group { margin-bottom: 15px; }
        select, input[type="text"] { padding: 10px; border-radius: 5px; border: 1px solid #ccc; width: 95%; margin-top: 5px; box-sizing: border-box; }
        .required-hint { color: #e74c3c; font-size: 0.8em; margin-left: 5px; }
    </style>
</head>
<body>
<h1 style="text-align:center; margin-bottom: 0;">æ›‰æ˜æ•¸å­¸ç§‘æœŸæœ«èšé¤</h1>
<h1 style="text-align:center; margin-top: 0;">äº¤é€šæ–¹å¼æš¨é›²ç«¯é»é¤çµ±è¨ˆç³»çµ±</h1>

    <div class="main-layout">
        <div class="menu-card">
            <div class="recommend-box">
                <strong>ğŸ’¡ æ¨è–¦é ç®—çµ„åˆ(ğŸ´é¤é»é ç®—$750 - $850)</strong><br>
                â€¢ ğŸ‘‘æµ·é®®ç‡‰é£¯($698) + 1çƒå†°æ·‡æ·‹($128) = $826 [3, 4]<br>
                â€¢ ğŸ‘‘å¹²è²å¥¶é†¬éºµ($588) + ğŸ‘‘ç¾…å‹’æª¸æª¬å¡”($228) = $816 [5, 6]<br>
                â€¢ ğŸ‘‘å£æ°´é›ç¾©éºµ($398) + ğŸ‘‘æ­åŸ¹æ‹‰($268) + ğŸ‘‘ç”œæ©™å’–å•¡($168) = $834 [5-7]
            </div>

            <div class="input-group">
                <label><strong>1. åŒä»å§“å</strong><span class="required-hint">*å¿…å¡«</span></label>
                <input type="text" id="userName" placeholder="è«‹è¼¸å…¥å§“å" oninput="updateUI()">
            </div>

            <div class="input-group">
                <label><strong>2. å‰å¾€æ–¹å¼</strong></label>
                <select id="transport">
                    <option value="è‡ªè¡Œå‰å¾€">è‡ªè¡Œå‰å¾€</option>
                    <option value="å°šç„¡äº¤é€šæ–¹å¼">å°šç„¡äº¤é€šæ–¹å¼</option>
                    <option value="å…±ä¹˜">å…±ä¹˜</option>
                </select>
            </div>
            <hr>
            <div id="menuContainer"></div>
        </div>

        <div class="summary-card">
            <h3>æ‚¨çš„é»é¤æ‘˜è¦</h3>
            <div id="selectedList" style="min-height: 50px; font-size: 0.9em; color: #ecf0f1;">å°šæœªé¸æ“‡é¤é»</div>
            <hr>
            <div style="font-size: 1.3em;">ç¸½é‡‘é¡ï¼š$<span id="totalDisplay">0</span></div>
            <div id="statusHint" style="color:#f1c40f; margin:10px 0; font-weight:bold;">è«‹è¼¸å…¥å§“åä¸¦é»é¤</div>
            
            <button id="submitBtn" class="btn-submit" onclick="uploadData()" disabled>ç¢ºèªæäº¤è‡³é›²ç«¯</button>
            <button class="btn-clear" onclick="clearOnlyMenu()">åƒ…æ¸…é™¤å·²é¸é¤é»</button>
            <p style="font-size: 0.8em; color: #bdc3c7; margin-top: 15px;">â€» é»é¸ä¸»é¤å‡é™„ç†”å²©èµ·å£«éºµåŒ…ä¹™ä»½ã€‚</p>
        </div>
    </div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxpraJFbxd7Q_x_xBiiztC4LW9Ka7dB18szbs1_Z-JcMbYsNUsFo5CQDSDKYipU4BXK/exec"; 
const budgetMin = 750, budgetMax = 850;
let currentItems = [], currentTotal = 0;

// å¾ä¾†æºè³‡æ–™ [1]-[2] æ•´åˆçš„å®Œæ•´æ•¸æ“š
const menuData = [
    { cat: "ä¸»å»šæ’é¤ (é™„éºµåŒ…)", items: [
        { n: "ğŸ‘‘ æŒªå¨é¦™ç…é®­é­šæ­åŒ—æµ·é“å¹²è²", p: 798 }, { n: "æ³•å¼æ²¹å°é´¨è…¿ä½æ¡‘è‘šæœé‡€é†¬æ±", p: 798 },
        { n: "ğŸ‘‘ ç¾©å¼æ¤’ç²’æµ·é¹½çƒ¤åŠé›", p: 698 }, { n: "å­£ç¯€é®®é­šä½é³³æ¢¨é¹¹æª¸æª¬", p: 898 }, { n: "PRIMEè²åŠ›ç‰›æ’", p: 1298 }
    ]},
    { cat: "ç¾©å¼ç‡‰é£¯/ç¾©å¤§åˆ©éºµ (é™„éºµåŒ…)", items: [
        { n: "ğŸ‘‘ é¦¬è³½ç„¡æ•µæµ·é®®ç‡‰é£¯", p: 698 }, { n: "ğŸ‘‘ åŒ—æ¸¯é»‘éº»æ²¹é›è‚‰", p: 398 }, { n: "ç¾…é¦¬è±¬è‚‰è”¥é¹½ç‡‰é£¯", p: 398 },
        { n: "ğŸ‘‘ åŒ—æµ·é“å¹²è²ä½å¥¶é†¬ç¾©å¤§åˆ©éºµ", p: 588 }, { n: "ğŸ‘‘ æ³°å¼é…¸è¾£é®®è¦", p: 488 }, { n: "è¥¿è¥¿é‡ŒèŒ„æ±é¦™ç…é›è…¿æ’", p: 428 },
        { n: "ğŸ‘‘ æ¸æ±Ÿå·è¾£å£æ°´é›çš®è›‹", p: 398 }, { n: "å¥¶æ²¹èµ·å¸é‡è‡(è”¬)", p: 398 }, { n: "é»‘æ¾éœ²æ²¹æ¸…ç‚’é®®è”¬é‡è‡", p: 388 }
    ]},
    { cat: "é–‹èƒƒèœ/æ²™æ‹‰/æ¹¯å“", items: [
        { n: "ğŸ‘‘ æ©„æ¬–æ²¹é¦™ç…ä¸­å·", p: 388 }, { n: "ğŸ‘‘ ç¾©å¼æ¸…ç‚’æ«›ç“œé®®è¦", p: 368 }, { n: "ğŸ‘‘ ç´å¥§è‰¯æ¥“ç³–åŸ¹æ ¹æ²™æ‹‰", p: 388 },
        { n: "ğŸ‘‘ é¦¬è³½è¦æ±æµ·é®®æ¸…æ¹¯", p: 368 }, { n: "ğŸ‘‘ æ—¥æœ¬æµ·ç‚¸ç‰¡è £", p: 228 }, { n: "æ¾éœ²é¦¬éˆ´è–¯çƒ", p: 228 },
        { n: "ç¶“å…¸è¥¿è¥¿é‡Œæµ·é¹½è„†è–¯", p: 198 }, { n: "æ³•å¼å—ç“œå …æœæ¿ƒæ¹¯", p: 168 }
    ]},
    { cat: "ç”œé»/å†°æ·‡æ·‹/ææ‹‰ç±³è˜‡", items: [
        { n: "ğŸ‘‘ æ³•å¼æ­åŸ¹æ‹‰", p: 268 }, { n: "å·´æ–¯å…‹ä¹³é…ªè›‹ç³•", p: 268 }, { n: "ğŸ‘‘ ç¶“å…¸åŸå‘³ææ‹‰ç±³è˜‡", p: 258 },
        { n: "ğŸ‘‘ ç¾…å‹’æª¸æª¬å¡”", p: 228 }, { n: "ğŸ‘‘ ç”œå¿ƒå†°æ·‡æ·‹(1çƒ)", p: 128 }, { n: "ç¾©å¼é˜¿æ³•å¥‡æœµ", p: 188 }, { n: "ğŸ‘‘ å¯éº—éœ²(ä¸€å…¥)", p: 88 }
    ]},
    { cat: "é£²å“/æœæ±/èŠ±è‰èŒ¶", items: [
        { n: "ğŸ‘‘ æ°´æœèŒ¶", p: 188 }, { n: "ğŸ‘‘ å°‹å‘³ç„™èŒ¶æ­è•¾", p: 188 }, { n: "ğŸ‘‘ ç”œæ©™/è¥¿è¥¿é‡Œå’–å•¡", p: 168 },
        { n: "æ‹¿éµ/å¡å¸ƒå¥‡è«¾", p: 168 }, { n: "æ³¡æ³¡çç å¥¶èŒ¶", p: 168 }, { n: "ç¾é¡æ·¨ç™½å¥‡ç•°æœæ±", p: 168 },
        { n: "æ´»åŠ›èˆ’æ´»ç¶œåˆæœæ±", p: 188 }, { n: "éŒ«è˜­ç´…èŒ¶/ç¾å¼å’–å•¡", p: 128 }
    ]}
];

function render() {
    const container = document.getElementById('menuContainer');
    container.innerHTML = '';
    menuData.forEach(cat => {
        let html = `<div class="category-title">${cat.cat}</div>`;
        cat.items.forEach(item => {
            const selected = currentItems.some(i => i.n === item.n);
            const disabled = !selected && (currentTotal + item.p > budgetMax);
            html += `<label class="item-label ${disabled?'disabled':''}">
                <input type="checkbox" onchange="toggle('${item.n}',${item.p},this)" ${selected?'checked':''} ${disabled?'disabled':''}>
                ${item.n} ($${item.p})</label>`;
        });
        container.innerHTML += html;
    });
    updateUI();
}

function toggle(n, p, el) {
    if (el.checked) { currentItems.push({n, p}); currentTotal += p; }
    else { currentItems = currentItems.filter(i => i.n !== n); currentTotal -= p; }
    render();
}

// åƒ…æ¸…é™¤èœå–®ï¼Œä¿ç•™å§“åèˆ‡äº¤é€šæ–¹å¼
function clearOnlyMenu() {
    currentItems = [];
    currentTotal = 0;
    render();
}

function updateUI() {
    const name = document.getElementById('userName').value.trim();
    document.getElementById('totalDisplay').innerText = currentTotal;
    document.getElementById('selectedList').innerText = currentItems.map(i => i.n).join(', ') || "å°šæœªé¸æ“‡";
    
    const btn = document.getElementById('submitBtn');
    const hint = document.getElementById('statusHint');
    
    const isBudgetOk = (currentTotal >= budgetMin && currentTotal <= budgetMax);
    const isNameOk = (name !== "");

    if (!isNameOk) {
        btn.disabled = true;
        hint.innerText = "âš ï¸ è«‹å…ˆå¡«å¯«å§“å";
        hint.style.color = "#f1c40f";
    } else if (!isBudgetOk) {
        btn.disabled = true;
        hint.style.color = "#e74c3c";
        hint.innerText = currentTotal > budgetMax ? "âŒ è¶…å‡ºé ç®—" : `é‚„å·® $${budgetMin - currentTotal} é”æ¨™`;
    } else {
        btn.disabled = false;
        hint.innerText = "âœ… å§“åèˆ‡é‡‘é¡çš†åˆæ ¼ï¼";
        hint.style.color = "#2ecc71";
    }
}

async function uploadData() {
    const name = document.getElementById('userName').value;
    const transport = document.getElementById('transport').value;
    const btn = document.getElementById('submitBtn');
    btn.disabled = true; btn.innerText = "ä¸Šå‚³ä¸­...";
    
    try {
        await fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify({ name, transport, items: currentItems.map(i=>i.n).join(' + '), total: currentTotal })
        });
        alert("æäº¤æˆåŠŸï¼");
        // æˆåŠŸå¾Œæ‰å®Œå…¨é‡ç½®
        currentItems = []; currentTotal = 0;
        document.getElementById('userName').value = '';
        render();
    } catch (e) {
        alert("æäº¤å¤±æ•—ã€‚");
        btn.disabled = false; btn.innerText = "ç¢ºèªæäº¤è‡³é›²ç«¯";
    }
}
render();
</script>
</body>
</html>